<beast version="2.0"
       namespace="beast.base.inference
                 :beast.base.inference.parameter
                 :beast.base.evolution.tree
                 :beast.base.evolution.alignment
                 :feast.simulation
                 :bdmmprime.distribution
                 :bdmmprime.parameterization
                 :bdmmprime.mapping">

    <typedTree spec="TypeMappedTree" id="typedTree" typeLabel="type" remapOnLog="false">

        <parameterization spec="CanonicalParameterization">
            <processLength spec="RealParameter" id="origin" value="1.0"/>
            <typeSet id="typeSet" spec="TypeSet" typeTraitSet="@typeTraitSet"/>
            <birthRate spec="SkylineVectorParameter">
                <skylineValues spec="RealParameter" value="3.0 3.0"/>
            </birthRate>
            <deathRate spec="SkylineVectorParameter" typeSet="@typeSet">
               <skylineValues spec="RealParameter" value="0.5 0.5"/>
            </deathRate>
            <migrationRate spec="SkylineMatrixParameter" typeSet="@typeSet">
                <skylineValues spec="RealParameter" value="0.2 0.3"/>
            </migrationRate>
            <samplingRate spec="SkylineVectorParameter" typeSet="@typeSet">
                <skylineValues spec="RealParameter" value="0.0"/>
            </samplingRate>
            <removalProb spec="SkylineVectorParameter" typeSet="@typeSet">
                <skylineValues spec="RealParameter" value="0.0"/>
            </removalProb>
            <rhoSampling spec="TimedParameter" typeSet="@typeSet" times="1.0">
                <values spec="RealParameter" value="0.2"/>
            </rhoSampling>

        </parameterization>

        <startTypePriorProbs spec="RealParameter" value="0.5 0.5"/>

        <typeTraitSet id="typeTraitSet" spec="TraitSet" traitname="type" taxa="@taxonSet">
            t1=0,t2=1
        </typeTraitSet>

        <untypedTree id="untypedTree" spec="TreeParser"
                     adjustTipHeights="false" IsLabelledNewick="true"
                     newick="(t1: 1.0, t2 : 1.0);"/>
        <taxonset spec="TaxonSet" id="taxonSet">
            <taxon spec="Taxon" id="t1"/>
            <taxon spec="Taxon" id="t2"/>
        </taxonset>
    </typedTree>


    <run spec="GPSimulator" nSims="100000">

        <simulationObject idref="typedTree"/>

<!--        <logger spec="Logger" logEvery="1" mode="tree" fileName="$(filebase).trees">-->
<!--            <log idref="typedTree"/>-->
<!--        </logger>-->

        <logger id="nodeTypedTreeLogger" spec="bdmmprime.util.OptionalLogger" enableLogger="true" fileName="$(filebase).trees" logEvery="1" mode="tree">
            <log id="nodeTypedTree" spec="bdmmprime.mapping.TypedNodeTreeLogger" typedTree="@typedTree"/>
        </logger>

        <logger spec="Logger" logEvery="1" fileName="$(filebase).log">
          <log spec="TypedTreeStatsLogger" typedTree="@typedTree" typeLabel="type"
               typeSet="@typeSet"/>
        </logger>
    </run>
</beast>
